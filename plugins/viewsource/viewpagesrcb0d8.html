                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711758 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:42:25 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpageb0d8.html?pageId=30711758" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors82a8.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom82a8.css?spaceKey=TECHDOC" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macroa4f0.png?definition=e3RvYzptYXhMZXZlbD0zfG91dGxpbmU9dHJ1ZX0&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="ee502a7c-a4df-4282-99bb-46b12013fdd0" data-macro-parameters="maxLevel=3|outline=true" data-macro-schema-version="1"></p><p><img class="confluence-embedded-image image-center" height="250" src="../../download/attachments/30711758/Beginners_Tutorial-RideList-view7ff0.png?version=1&amp;modificationDate=1460548920000&amp;api=v2" data-image-src="/download/attachments/30711758/Beginners_Tutorial-RideList-view.png?version=1&amp;modificationDate=1460548920000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="31429264" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Beginners_Tutorial-RideList-view.png" data-base-url="https://doc.ez.no" data-linked-resource-content-type="image/png" data-linked-resource-container-id="30711758" data-linked-resource-container-version="35" title="TECHDOC > Step 2 - Display the list of Rides on the homepage > Beginners_Tutorial-RideList-view.png" data-location="TECHDOC > Step 2 - Display the list of Rides on the homepage > Beginners_Tutorial-RideList-view.png" data-image-height="571" data-image-width="1115"></p><h2>Custom your homepage template</h2><p>Let's modify the <code>Resources/views/content/full/root_folder.html.twig<strong> </strong></code> adding a call to a subrequest to display the list of all existing Rides with pagination:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="724ab93c-d5d7-4983-a9c3-3bc8858edb73" data-macro-parameters="language=xml|linenumbers=true|theme=RDark|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading8f03.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRoZW1lPVJEYXJrfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ3xsaW5lbnVtYmVycz10cnVlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% extends "pagelayout.html.twig" %}

{% block content %}
    &lt;script src="http://maps.google.com/maps/api/js?sensor=false">&lt;/script>

    &lt;h3 class="center bottom-plus new-header">{{ ez_content_name(content) }}&lt;/h3>
    &lt;div class="col-xs-10 text-justified">
    {{ render( controller( "AppBundle:Homepage:getAllRides" ) ) }}

{% endblock %}</pre></td></tr></table><p> For the moment, we use a simple <code>render()</code> Twig function but when we talk about cache, we will use <code><a href="../../display/EZP/Content%2bview65bc.html?focusedCommentId=27394205#Contentview-ESI"><strong>render_esi</strong></a></code>.</p><h2>Create your sub controller to display list of Rides</h2><p>Create your <code>/src/AppBundle/Controller/HomepageController.php </code>with the function <code>getAllRidesAction</code>:<strong><br /></strong></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ebecabf9-ba0e-40ce-8473-7285b7ee36d1" data-macro-parameters="language=php|linenumbers=true|theme=RDark|title=HomepageController.php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading5ba1.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRoZW1lPVJEYXJrfHRpdGxlPUhvbWVwYWdlQ29udHJvbGxlci5waHB8bGluZW51bWJlcnM9dHJ1ZX0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;?php
namespace AppBundle\Controller;
use eZ\Publish\API\Repository\Values\Content\Query;
use eZ\Publish\API\Repository\Values\Content\Query\Criterion;
use eZ\Publish\Core\MVC\Symfony\Controller\Controller;
use eZ\Publish\API\Repository\Values\Content\Query\SortClause;
use eZ\Publish\Core\Pagination\Pagerfanta\ContentSearchAdapter;
use Pagerfanta\Pagerfanta;
use Symfony\Component\HttpFoundation\Request;
use eZ\Publish\API\Repository\Values\Content\Location;
use eZ\Publish\API\Repository\Values\Content\LocationQuery;
class HomepageController extends Controller
{
    public function getAllRidesAction(Request $request)
    {
        $repository = $this->getRepository();
        $locationService = $repository->getLocationService();
        $contentService = $repository->getContentService();
        $rootLocationId = $this->getConfigResolver()->getParameter('content.tree_root.location_id');
        $rootLocation = $locationService->loadLocation($rootLocationId);
        $currentLocationId = 2;
        $currentLocation = $locationService->loadLocation($currentLocationId);
        $currentContent = $contentService->loadContentByContentInfo($currentLocation->contentInfo);
        $query = new Query();
        $query->query = new Criterion\LogicalAnd(
            array(
                new Criterion\Subtree($rootLocation->pathString),
                new Criterion\Visibility(Criterion\Visibility::VISIBLE),
                new Criterion\ContentTypeIdentifier(array('ride'))
            )
        );
        $query->sortClauses = array(
            new SortClause\DatePublished(Query::SORT_ASC)
        );
        $pager = new Pagerfanta(
            new ContentSearchAdapter($query, $this->getRepository()->getSearchService())
        );
        //FIXME : get $limit value from a custom parameter
        $limit = 10;
        $pager->setMaxPerPage($limit);
        $pager->setCurrentPage($request->get('page', 1));
        return $this->render(
            'content/view/list/rides.html.twig',
            array(
                'location' => $currentLocation,
                'content' => $currentContent,
                'pagerRides' => $pager,
            )
        );
    }
}</pre></td></tr></table><h2>Create template to display the list of Rides</h2><p>Create <code>app/Resources/AppBundle/views/list/rides.html.twig </code>template. You use a &lt;table&gt; to display the list of rides. The &lt;thead&gt; of the &lt;table&gt; is in this Ride list template and each &lt;tr&gt; (line of the table) is in the line ride template.</p><p>So each time you will use the line Ride template, you have to remember the choice of using a &lt;tr&gt;.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3b509037-fc10-4da2-9c46-48bfa89d2cd5" data-macro-parameters="language=xml|linenumbers=true|theme=RDark|title=rides.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading2ba9.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRoZW1lPVJEYXJrfHRpdGxlPXJpZGVzLmh0bWwudHdpZ3xsaW5lbnVtYmVycz10cnVlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{#Only display pagerfanta navigator if needed.#}
{% if pagerRides.haveToPaginate() %}
&lt;nav class="text-center">
    &lt;ul class="pagination">
    &lt;div class="pagerfanta">
        {{ pagerfanta( pagerRides, 'twitter_bootstrap_translated', {'routeName': location } ) }}
    &lt;/div>
    &lt;/ul>
&lt;/nav>
{% endif %}
&lt;div class="row regular-content-size">
    &lt;div class="col-md-8 col-md-offset-2 box-style">
        &lt;h3 class="center bottom-plus new-header">{{ 'List of all Rides' | trans }}&lt;/h3>
        {# Loop over the page results #}
        {% for ride in pagerRides %}
            {% if loop.first %}
                &lt;table class="table table-hover">
                &lt;thead>
                &lt;tr class="table-header">
                    &lt;th>&lt;/th>
                    &lt;th>Name&lt;/th>
                    &lt;th>Starting Point&lt;/th>
                    &lt;th>Ending Point&lt;/th>
                    &lt;th>Length&lt;/th>
                    &lt;th>Level&lt;/th>
                &lt;/tr>
                &lt;/thead>
                &lt;tbody>
            {% endif %}
            {{ render( controller( 'ez_content:viewLocation', { 'locationId': ride.versionInfo.contentInfo.mainLocationId, 'viewType': 'line' } )) }}
            {% if loop.last %}
                &lt;/tbody>
                &lt;/table>
            {% endif %}
        {% endfor %}
    &lt;/div>
&lt;/div>
{#Only display pagerfanta navigator if needed.#}
{% if pagerRides.haveToPaginate() %}
    &lt;nav class="text-center">
        &lt;ul class="pagination">
            &lt;div class="pagerfanta">
                {{ pagerfanta( pagerRides, 'twitter_bootstrap_translated', {'routeName': location } ) }}
            &lt;/div>
        &lt;/ul>
    &lt;/nav>
{% endif %}</pre></td></tr></table><p>The next step is to create the override rule to use a dedicated template for the view line of Rides.</p><p>To do so, you need to configure your bundle to inject override configuration.</p><h2><span>Use a custom template to display view line of a Ride</span></h2><p>You add the rule for the line_ride template to be used in your <code>app/config/ezplatform.yml </code>file.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="2acc506a-6930-4ea9-be2f-80a7355d90ea" data-macro-parameters="language=groovy|theme=RDark|title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading857d.png?definition=e2NvZGU6bGFuZ3VhZ2U9Z3Jvb3Z5fHRoZW1lPVJEYXJrfHRpdGxlPWV6cGxhdGZvcm0ueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>system:
    site_group:
        content_view:
            line:
                line_ride:
                    template: "content/view/line/ride.html.twig"
                    match:
                        Identifier\ContentType: "ride"</pre></td></tr></table><p>Create your <code>app/Resources/AppBundle/views/content/view/line/ride.html.twig </code>template. Remember, it's only one line of a table, so you will find a &lt;tr&gt; tag with some &lt;td&gt; tags.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="f017dd44-5b0a-429e-9ab2-048bacf5abbe" data-macro-parameters="language=xml|linenumbers=true|theme=RDark|title=ride.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading20d8.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRoZW1lPVJEYXJrfHRpdGxlPXJpZGUuaHRtbC50d2lnfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;tr>
    &lt;td>
        {{ ez_render_field( content, 'image', { parameters: { 'alias': 'small' }} ) }}
    &lt;/td>
    &lt;td>
        &lt;strong>
            &lt;a href="{{ path( "ez_urlalias", { 'locationId': content.contentInfo.mainLocationId } ) }}"
               target="_self">
                {{ ez_content_name( content ) }}
            &lt;/a>
        &lt;/strong>
        &lt;p class="pre-small">
            {{ ez_render_field( content, 'author') }}
        &lt;/p>
    &lt;/td>
    &lt;td>
        {{ ez_render_field(content, 'starting_point', {'parameters': {'width': '100%', 'height': '100px', 'showMap': true, 'showInfo': true }}
        ) }}
    &lt;/td>
    &lt;td>
        {{ ez_render_field(content, 'ending_point', {'parameters': {'width': '100%', 'height': '100px', 'showMap': true, 'showInfo': true }}
        ) }}
    &lt;/td>
    &lt;td>
        &lt;p>{{ ez_render_field( content, 'length' ) }} Km&lt;/p>
    &lt;/td>
    &lt;td>
        &lt;p>{{ ez_render_field( content, 'level' ) }}&lt;/p>
    &lt;/td>
&lt;/tr></pre></td></tr></table><p> </p><hr /><p /><p> </p><table class="wysiwyg-macro" data-macro-name="section" data-macro-id="1ba9de4b-2033-47f7-af29-19813c847b54" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading83a9.png?definition=e3NlY3Rpb259&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><table class="wysiwyg-macro" data-macro-name="column" data-macro-id="9747f986-84e6-4a84-b480-5ecb470a748a" data-macro-parameters="width=50%" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading99b3.png?definition=e2NvbHVtbjp3aWR0aD01MCV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>⬅ Previous: <a class="confluence-link" href="../../display/TECHDOC/Step%2b1%2b-%2bDisplay%2bcontent%2bof%2ba%2bRide.html" data-linked-resource-id="30711760" data-linked-resource-version="30" data-linked-resource-type="page" data-linked-resource-default-alias="Step 1 - Display content of a Ride" data-base-url="../../index.html">Step 1 - Display content of a Ride</a></p></td></tr></table><table class="wysiwyg-macro" data-macro-name="column" data-macro-id="5d4021d3-7fa8-43e1-95c8-6d417b68d02c" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading16cd.png?definition=e2NvbHVtbn0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p style="text-align: right;">Next : <a class="confluence-link" href="../../pages/viewpage1576.html?pageId=31429279" data-linked-resource-id="31429279" data-linked-resource-version="4" data-linked-resource-type="page" data-linked-resource-default-alias="Congrats!" data-base-url="../../index.html">Congrats!</a> ➡</p></td></tr></table></td></tr></table></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<table class="wysiwyg-macro" data-macro-name="panel" data-macro-id="d8c77d99-57aa-4735-a392-c4f56fe8f2c9" data-macro-parameters="borderColor=#f58220|borderWidth=2|title=Tutorial path" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingc82d-2.png?definition=e3BhbmVsOmJvcmRlckNvbG9yPSNmNTgyMjB8Ym9yZGVyV2lkdGg9Mnx0aXRsZT1UdXRvcmlhbCBwYXRofQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4664.png?definition=e3BhZ2V0cmVlOnJvb3Q9QmVnaW5uZXIgVHV0b3JpYWx9&amp;locale=en_GB&amp;version=2" data-macro-name="pagetree" data-macro-id="efeebae5-f6bb-4d5e-98b2-cc9365773177" data-macro-parameters="root=Beginner Tutorial" data-macro-schema-version="1"></p></td></tr></table></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711758 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:42:26 GMT -->
</html>
